"undefined"==typeof window.Mozilla&&(window.Mozilla={}),function(){"use strict";window.dataLayer=window.dataLayer||[];var t={COOKIE_CODE_ID:"moz-stub-attribution-code",COOKIE_SIGNATURE_ID:"moz-stub-attribution-sig",DLSOURCE:"fxdotcom"};t.experimentName,t.experimentVariation,t.successCallback,t.timeoutCallback,t.requestComplete=!1,t.withinAttributionRate=function(){return Math.random()<t.getAttributionRate()},t.getAttributionRate=function(){var t=document.getElementsByTagName("html")[0].getAttribute("data-stub-attribution-rate");return isNaN(t)||!t?0:Math.min(Math.max(parseFloat(t),0),1)},t.hasCookie=function(){return Mozilla.Cookies.hasItem(t.COOKIE_CODE_ID)&&Mozilla.Cookies.hasItem(t.COOKIE_SIGNATURE_ID)},t.setCookie=function(e){if(e.attribution_code&&e.attribution_sig){var i=new Date;i.setTime(i.getTime()+864e5);var n=i.toUTCString();Mozilla.Cookies.setItem(t.COOKIE_CODE_ID,e.attribution_code,n,"/",undefined,!1,"lax"),Mozilla.Cookies.setItem(t.COOKIE_SIGNATURE_ID,e.attribution_sig,n,"/",undefined,!1,"lax")}},t.removeCookie=function(){window.Mozilla.Cookies.removeItem(t.COOKIE_CODE_ID,"/",undefined,!1,"lax"),window.Mozilla.Cookies.removeItem(t.COOKIE_SIGNATURE_ID,"/",undefined,!1,"lax")},t.getCookie=function(){return{attribution_code:Mozilla.Cookies.getItem(t.COOKIE_CODE_ID),attribution_sig:Mozilla.Cookies.getItem(t.COOKIE_SIGNATURE_ID)}},t.updateBouncerLinks=function(e){if(e.attribution_code&&e.attribution_sig&&t.meetsRequirements())for(var i=document.querySelectorAll(".download-link"),n=0;n<i.length;n++){var o,r,a=i[n];!a.href||-1===a.href.indexOf("https://download.mozilla.org")&&-1===a.href.indexOf("https://bouncer-bouncer.stage.mozaws.net/")&&-1===a.href.indexOf("https://stage.bouncer.nonprod.webservices.mozgcp.net")&&-1===a.href.indexOf("https://dev.bouncer.nonprod.webservices.mozgcp.net")?a.href&&-1!==a.href.indexOf("/thanks/")&&(r=a.getAttribute("data-direct-link"))&&a.setAttribute("data-direct-link",Mozilla.StubAttribution.appendToDownloadURL(r,e)):((o=a.getAttribute("data-download-version"))&&/win/.test(o)&&(a.href=Mozilla.StubAttribution.appendToDownloadURL(a.href,e)),o&&/osx/.test(o)&&!/product=firefox-esr/.test(a.href)&&(a.href=Mozilla.StubAttribution.appendToDownloadURL(a.href,e)))}},t.removeLinkAttributionParams=function(t){if(t.indexOf("?")>0){var e=new window._SearchParams(t.split("?")[1]),i=t.split("?")[0];if(e.has("attribution_code")&&e.has("attribution_sig"))return e.remove("attribution_code"),e.remove("attribution_sig"),i+"?"+window.decodeURIComponent(e.toString())}return t},t.cleanBouncerLinks=function(){for(var e=document.querySelectorAll(".download-link"),i=0;i<e.length;i++)if(e[i].href=t.removeLinkAttributionParams(e[i].href),e[i].hasAttribute("data-direct-link")){var n=t.removeLinkAttributionParams(e[i].getAttribute("data-direct-link"));e[i].setAttribute("data-direct-link",n)}},t.removeAttributionData=function(){t.removeCookie(),t.cleanBouncerLinks(),t.requestComplete=!1},t.appendToDownloadURL=function(t,e){if(!e.attribution_code||!e.attribution_sig)return t;for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&("attribution_code"!==i&&"attribution_sig"!==i||(t+=(t.indexOf("?")>-1?"&":"?")+i+"="+e[i]));return t},t.onRequestSuccess=function(e){e.attribution_code&&e.attribution_sig&&!t.requestComplete&&(t.updateBouncerLinks(e),t.setCookie(e),t.requestComplete=!0,"function"==typeof t.successCallback&&t.successCallback())},t.onRequestTimeout=function(){t.requestComplete||(t.requestComplete=!0,"function"==typeof t.timeoutCallback&&t.timeoutCallback())},t.requestAuthentication=function(e){var i=window.location.protocol+"//"+window.location.host+"/en-US/stub_attribution_code/",n=new window.XMLHttpRequest,o=setTimeout(t.onRequestTimeout,1e4);n.open("GET",i+"?"+window._SearchParams.objectToQueryString(e)),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onreadystatechange=function(){if(4===n.readyState){var e=n.status;if(e&&e>=200&&e<400)try{var i=JSON.parse(n.responseText);clearTimeout(o),t.onRequestSuccess(i)}catch(r){t.onRequestTimeout()}}},n.timeout=1e4,n.send()},t.getUserAgent=function(t){return t=void 0!==t?t:navigator.userAgent,/MSIE|Trident/i.test(t)?"ie":/Edg|Edge/i.test(t)?"edge":/Firefox/.test(t)?"firefox":/Chrome/.test(t)?"chrome":"other"},t.getGtagClientID=function(t){t=void 0!==t?t:window.dataLayer;var e=null;function i(t){for(var n in t)if("object"==typeof t[n]&&Object.prototype.hasOwnProperty.call(t,n)){if("gtagApiResult"===n){if("string"!=typeof t[n].client_id)return e;e=t[n].client_id;break}i(t[n])}}try{"object"==typeof t&&t.forEach((function(t){i(t)}))}catch(n){return window.dataLayer.push({event:"log",label:"getGtagClientID error: "+n}),null}return e},t.createSessionID=function(){return Math.floor(1e9+9e9*Math.random()).toString()},t.waitForGoogleAnalyticsThen=function(e){var i,n=0;!function o(){clearTimeout(i);var r=t.getGtagClientID();r?e(!0):n<=20?(n+=1,i=window.setTimeout(o,100)):e(!!r)}()},t.getAttributionData=function(e,i){var n=new window._SearchParams,o=n.utmParams(),r=i?null:n.get("experiment")||t.experimentName,a=i?null:n.get("variation")||t.experimentVariation,u="string"==typeof e?e:document.referrer,s=i?"other":t.getUserAgent(),l=i?null:t.getGtagClientID(),d={utm_source:o.utm_source,utm_medium:o.utm_medium,utm_campaign:o.utm_campaign,utm_content:o.utm_content,referrer:u,ua:s,experiment:r,variation:a,client_id_ga4:l,session_id:l?t.createSessionID():null,dlsource:t.DLSOURCE};for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&("undefined"!=typeof d[c]&&null!==d[c]||delete d[c]);return d},t.hasValidData=function(t){if("string"==typeof t.utm_content&&"string"==typeof t.referrer){var e=t.utm_content;if(e.length>150)return!1;for(;-1!==e.indexOf("%");)try{var i=decodeURIComponent(e);if(i===e)break;e=i}catch(n){break}if(/^rta:/.test(e)&&-1===t.referrer.indexOf("https://addons.mozilla.org"))return!1}return!0},t.isFirefoxDownloadThanks=function(t){return(t=void 0!==t?t:window.location.href).indexOf("/thanks/")>-1},t.meetsRequirements=function(){return"undefined"!=typeof window.site&&"undefined"!=typeof Mozilla.Cookies&&"undefined"!=typeof window._SearchParams&&!!Mozilla.Cookies.enabled()&&!!/windows|osx/i.test(window.site.platform)},t.init=function(e,i,n=!1){var o={};t.meetsRequirements()&&("function"==typeof e&&(t.successCallback=e),"function"==typeof i&&(t.timeoutCallback=i),t.hasCookie()?(o=t.getCookie(),t.updateBouncerLinks(o)):t.isFirefoxDownloadThanks()||t.waitForGoogleAnalyticsThen((function(){(o=t.getAttributionData(null,n))&&t.withinAttributionRate()&&t.hasValidData(o)&&(t.requestAuthentication(o),o.client_id_ga4&&window.dataLayer.push({event:"stub_session_set",id:o.session_id}))})))},window.Mozilla.StubAttribution=t}(),function(){"use strict";var t="moz-consent-pref";function e(){try{return JSON.parse(window.Mozilla.Cookies.getItem(t))}catch(e){return!1}}var i={handleConsent:function(t){t.detail.analytics&&(window.Mozilla.StubAttribution.init(),window.removeEventListener("mozConsentStatus",i.handleConsent,!1))},init:function(){var t;if(!("function"==typeof window.Mozilla.gpcEnabled&&window.Mozilla.gpcEnabled()||"function"==typeof window.Mozilla.dntEnabled&&window.Mozilla.dntEnabled()))if((t=document.getElementsByTagName("html")[0].getAttribute("data-needs-consent"))&&"true"===t.toLowerCase()){var n=e();window.Mozilla.StubAttribution.isFirefoxDownloadThanks()&&n&&n.analytics?window.Mozilla.StubAttribution.init():window.addEventListener("mozConsentStatus",i.handleConsent,!1)}else{var o=e();if(o&&!o.analytics)return;window.Mozilla.StubAttribution.init()}}};i.init()}();